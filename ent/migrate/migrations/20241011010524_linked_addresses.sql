-- Create "linked_addresses" table
CREATE TABLE "linked_addresses" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 90194313216), "created_at" timestamptz NOT NULL, "updated_at" timestamptz NOT NULL, "address" character varying NOT NULL, "salt" bytea NOT NULL, "institution" character varying NOT NULL, "account_identifier" character varying NOT NULL, "account_name" character varying NOT NULL, "owner_address" character varying NOT NULL, "last_indexed_block" bigint NULL, "tx_hash" character varying NULL, "sender_profile_linked_address" uuid NULL, PRIMARY KEY ("id"), CONSTRAINT "linked_addresses_sender_profiles_linked_address" FOREIGN KEY ("sender_profile_linked_address") REFERENCES "sender_profiles" ("id") ON UPDATE NO ACTION ON DELETE CASCADE);
-- Create index "linked_addresses_address_key" to table: "linked_addresses"
CREATE UNIQUE INDEX "linked_addresses_address_key" ON "linked_addresses" ("address");
-- Create index "linked_addresses_owner_address_key" to table: "linked_addresses"
CREATE UNIQUE INDEX "linked_addresses_owner_address_key" ON "linked_addresses" ("owner_address");
-- Create index "linked_addresses_salt_key" to table: "linked_addresses"
CREATE UNIQUE INDEX "linked_addresses_salt_key" ON "linked_addresses" ("salt");
-- Modify "payment_orders" table
ALTER TABLE "payment_orders" ALTER COLUMN "sender_profile_payment_orders" DROP NOT NULL, ADD COLUMN "linked_address_payment_orders" bigint NULL, ADD CONSTRAINT "payment_orders_linked_addresses_payment_orders" FOREIGN KEY ("linked_address_payment_orders") REFERENCES "linked_addresses" ("id") ON UPDATE NO ACTION ON DELETE SET NULL;
-- Add pk ranges for ('linked_addresses') tables
INSERT INTO "ent_types" ("type") VALUES ('linked_addresses');
